<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Warga RT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="DataWarga_RT.css">
</head>

<body>
    <aside class="sidebar">
        <div>
            <div class="sidebar-header">
                <h1>SITAWAR</h1>
                <p>Sistem Terpadu Administrasi Warga</p>
            </div>
            <nav class="nav">
                <a href="Dashboard_RT.html">Dashboard</a>
                <a href="#">Data Warga</a>
                <a href="Dokumen_RT.html">Dokumen</a>
                <a href="Laporan_ RT.html">Laporan</a>
            </nav>
        </div>
        <div class="sidebar-footer">
            Â© 2025 RT Smart System
        </div>
    </aside>
    <div class="home" style="height: 100vh; ">
        <h2>Data Warga</h2>
        <div class="card-home">
            <h3>RT 01 RW 02</h3>
            <h5>Kelurahan Sukamaju, Kecamatan Cilandak, Kota Jakarta Selatan</h5>
            <p>halaman pengelolaan data warga dapat melakukan pencarian cepat data warga berdasarkan Nama dan NIK,
                memberikan statistik jumlah warga berdasarkan usia dan dapat menghapus data warga beserta mengupdate
                data warga</p>
        </div>
        <div class="filter-bar">
            <input type="text" id="searchNama" placeholder="Cari Nama..." class="form-control" style="width: 250px;">
            <input type="text" id="searchKK" placeholder="Cari No KK..." class="form-control" style="width: 250px;">
            <select id="filterGender" class="form-select" style="width: 200px;">
                <option value="">Jenis Kelamin</option>
                <option value="Laki-laki">Laki-laki</option>
                <option value="Perempuan">Perempuan</option>
            </select>
            <button class="btn btn-green" onclick="applyFilter()">Filter</button>
            <button class="btn btn-green" onclick="resetFilter()">Reset</button>
            <button class="btn btn-green" onclick="tampilStatistik()">ðŸ“Š Statistik</button>
        </div>

        <table id="tabelWarga">
            <thead>
                <tr>
                    <th>Nama</th>
                    <th>NIK</th>
                    <th>Status Keluarga</th>
                    <th>No KK</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>

        <!-- Modal Detail -->
        <div class="modal fade" id="modalDetail" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Detail Data Warga</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <table class="table">
                            <tbody id="detailBody"></tbody>
                        </table>
                        <div class="d-flex justify-content-end gap-2 mt-3">
                            <button class="btn btn-danger" id="btnHapus">Hapus Data</button>
                            <button class="btn btn-green" id="btnPerbarui">Perbarui Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Password -->
        <div class="modal fade" id="modalPassword" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Verifikasi Password</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <p>Masukkan password untuk melanjutkan:</p>
                        <input type="password" id="inputPassword" class="form-control" placeholder="Password...">
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button class="btn btn-green" id="btnValidasi">Verifikasi</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Perbarui Data -->
        <div class="modal fade" id="modalEdit" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Perbarui Data Warga</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label>Pilih Kolom yang Ingin Diubah:</label>
                            <select id="selectKolom" class="form-select">
                                <option value="nama">Nama</option>
                                <option value="pekerjaan">Pekerjaan</option>
                                <option value="hp">No HP</option>
                                <option value="agama">Agama</option>
                                <option value="perkawinan">Status Perkawinan</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label>Masukkan Nilai Baru:</label>
                            <input type="text" id="inputNilaiBaru" class="form-control">
                        </div>
                        <div class="mb-3">
                            <label>Password Validasi:</label>
                            <input type="password" id="inputPasswordEdit" class="form-control"
                                placeholder="Password...">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <button class="btn btn-green" id="btnSimpanEdit">Simpan Perubahan</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Statistik -->
        <div class="modal fade" id="modalStatistik" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Statistik Berdasarkan Usia</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body"><canvas id="chartUsia"></canvas></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
/*         const warga = [
            { nama: "Andi", nik: "1001", status: "Kepala Keluarga", kk: "111", usia: 35, gender: "Laki-laki", ttl: "Jakarta, 10 Mei 1989", agama: "Islam", rt: "01", rw: "02", perkawinan: "Menikah", pekerjaan: "Karyawan", hp: "0812345678" },
            { nama: "Citra", nik: "1003", status: "Kepala Keluarga", kk: "222", usia: 40, gender: "Perempuan", ttl: "Bogor, 11 Maret 1985", agama: "Kristen", rt: "02", rw: "03", perkawinan: "Menikah", pekerjaan: "Guru", hp: "0812349999" },
            { nama: "Gilang", nik: "1007", status: "Kepala Keluarga", kk: "444", usia: 28, gender: "Laki-laki", ttl: "Jakarta, 2 Des 1996", agama: "Islam", rt: "04", rw: "01", perkawinan: "Menikah", pekerjaan: "Programmer", hp: "0812555555" },
            { nama: "Nina", nik: "1014", status: "Kepala Keluarga", kk: "888", usia: 33, gender: "Perempuan", ttl: "Bogor, 10 Des 1991", agama: "Islam", rt: "07", rw: "01", perkawinan: "Menikah", pekerjaan: "Perawat", hp: "0812344002" },
            { nama: "Andi", nik: "1001", status: "Kepala Keluarga", kk: "111", usia: 35, gender: "Laki-laki", ttl: "Jakarta, 10 Mei 1989", agama: "Islam", rt: "01", rw: "02", perkawinan: "Menikah", pekerjaan: "Karyawan", hp: "0812345678" },
            { nama: "Budi", nik: "1002", status: "Anggota Keluarga", kk: "111", usia: 30, gender: "Laki-laki", ttl: "Bandung, 4 Jan 1995", agama: "Islam", rt: "01", rw: "02", perkawinan: "Menikah", pekerjaan: "Wiraswasta", hp: "0812341111" },
            { nama: "Citra", nik: "1003", status: "Kepala Keluarga", kk: "222", usia: 40, gender: "Perempuan", ttl: "Bogor, 11 Maret 1985", agama: "Kristen", rt: "02", rw: "03", perkawinan: "Menikah", pekerjaan: "Guru", hp: "0812349999" },
            { nama: "Dewi", nik: "1004", status: "Anggota Keluarga", kk: "222", usia: 18, gender: "Perempuan", ttl: "Depok, 21 April 2007", agama: "Kristen", rt: "02", rw: "03", perkawinan: "Belum Menikah", pekerjaan: "Pelajar", hp: "0812123456" },
            { nama: "Eko", nik: "1005", status: "Kepala Keluarga", kk: "333", usia: 50, gender: "Laki-laki", ttl: "Bekasi, 9 Juli 1975", agama: "Islam", rt: "03", rw: "01", perkawinan: "Menikah", pekerjaan: "Petani", hp: "0812987654" },
            { nama: "Farah", nik: "1006", status: "Anggota Keluarga", kk: "333", usia: 45, gender: "Perempuan", ttl: "Bekasi, 20 Juli 1980", agama: "Islam", rt: "03", rw: "01", perkawinan: "Menikah", pekerjaan: "IRT", hp: "0812987000" },
            { nama: "Gilang", nik: "1007", status: "Kepala Keluarga", kk: "444", usia: 28, gender: "Laki-laki", ttl: "Jakarta, 2 Des 1996", agama: "Islam", rt: "04", rw: "01", perkawinan: "Menikah", pekerjaan: "Programmer", hp: "0812555555" },
            { nama: "Hana", nik: "1008", status: "Anggota Keluarga", kk: "444", usia: 25, gender: "Perempuan", ttl: "Jakarta, 15 Juni 1999", agama: "Islam", rt: "04", rw: "01", perkawinan: "Menikah", pekerjaan: "Desainer", hp: "0812666666" },
            { nama: "Indra", nik: "1009", status: "Kepala Keluarga", kk: "555", usia: 60, gender: "Laki-laki", ttl: "Tangerang, 7 Juli 1964", agama: "Islam", rt: "05", rw: "02", perkawinan: "Menikah", pekerjaan: "Pensiunan", hp: "0812777777" },
            { nama: "Joko", nik: "1010", status: "Anggota Keluarga", kk: "555", usia: 58, gender: "Perempuan", ttl: "Tangerang, 5 Mei 1966", agama: "Islam", rt: "05", rw: "02", perkawinan: "Menikah", pekerjaan: "IRT", hp: "0812888888" },
            { nama: "Kiki", nik: "1011", status: "Kepala Keluarga", kk: "666", usia: 22, gender: "Perempuan", ttl: "Jakarta, 4 Maret 2003", agama: "Islam", rt: "06", rw: "03", perkawinan: "Belum Menikah", pekerjaan: "Mahasiswa", hp: "0812999999" },
            { nama: "Lukman", nik: "1012", status: "Kepala Keluarga", kk: "777", usia: 45, gender: "Laki-laki", ttl: "Bandung, 3 Jan 1979", agama: "Islam", rt: "06", rw: "04", perkawinan: "Menikah", pekerjaan: "Polisi", hp: "0812344000" },
            { nama: "Mila", nik: "1013", status: "Anggota Keluarga", kk: "777", usia: 41, gender: "Perempuan", ttl: "Bandung, 12 Okt 1983", agama: "Islam", rt: "06", rw: "04", perkawinan: "Menikah", pekerjaan: "Guru", hp: "0812344001" },
            { nama: "Nina", nik: "1014", status: "Kepala Keluarga", kk: "888", usia: 33, gender: "Perempuan", ttl: "Bogor, 10 Des 1991", agama: "Islam", rt: "07", rw: "01", perkawinan: "Menikah", pekerjaan: "Perawat", hp: "0812344002" },
            { nama: "Oki", nik: "1015", status: "Anggota Keluarga", kk: "888", usia: 10, gender: "Laki-laki", ttl: "Bogor, 2 Mar 2015", agama: "Islam", rt: "07", rw: "01", perkawinan: "Belum Menikah", pekerjaan: "Pelajar", hp: "0812344003" },
            { nama: "Putri", nik: "1016", status: "Kepala Keluarga", kk: "999", usia: 27, gender: "Perempuan", ttl: "Jakarta, 9 Nov 1997", agama: "Islam", rt: "08", rw: "02", perkawinan: "Menikah", pekerjaan: "Karyawan", hp: "0812344004" },
            { nama: "Qori", nik: "1017", status: "Anggota Keluarga", kk: "999", usia: 5, gender: "Perempuan", ttl: "Jakarta, 1 Mei 2020", agama: "Islam", rt: "08", rw: "02", perkawinan: "Belum Menikah", pekerjaan: "-", hp: "-" },
            { nama: "Rizky", nik: "1018", status: "Kepala Keluarga", kk: "1000", usia: 32, gender: "Laki-laki", ttl: "Depok, 5 Jun 1992", agama: "Islam", rt: "09", rw: "02", perkawinan: "Menikah", pekerjaan: "Wiraswasta", hp: "0812344005" },
            { nama: "Siti", nik: "1019", status: "Anggota Keluarga", kk: "1000", usia: 30, gender: "Perempuan", ttl: "Depok, 9 Feb 1994", agama: "Islam", rt: "09", rw: "02", perkawinan: "Menikah", pekerjaan: "Karyawan", hp: "0812344006" },
            { nama: "Tono", nik: "1020", status: "Kepala Keluarga", kk: "1011", usia: 65, gender: "Laki-laki", ttl: "Bekasi, 3 Mar 1959", agama: "Islam", rt: "10", rw: "03", perkawinan: "Menikah", pekerjaan: "Pensiunan", hp: "0812344007" },
        ]; */

        let selectedNik = null;
        let modeAksi = ""; // "hapus" atau "edit"

        function tampilkanData(data) {
            const tbody = document.getElementById("dataWarga");
            tbody.innerHTML = data.map(w => `
        <tr>
          <td>${w.nama}</td>
          <td>${w.nik}</td>
          <td>${w.status}</td>
          <td>${w.kk}</td>
          <td><button class="btn btn-green btn-sm" onclick="lihatDetail('${w.nik}')">Kelola Data</button></td>
        </tr>`).join('');
        }

        function lihatDetail(nik) {
            selectedNik = nik;
            const w = warga.find(x => x.nik === nik);
            const d = document.getElementById("detailBody");
            d.innerHTML = `
        <tr><th>Nama</th><td>${w.nama}</td></tr>
        <tr><th>NIK</th><td>${w.nik}</td></tr>
        <tr><th>No KK</th><td>${w.kk}</td></tr>
        <tr><th>Tempat/Tanggal Lahir</th><td>${w.ttl}</td></tr>
        <tr><th>Agama</th><td>${w.agama}</td></tr>
        <tr><th>RT/RW</th><td>${w.rt}/${w.rw}</td></tr>
        <tr><th>Jenis Kelamin</th><td>${w.gender}</td></tr>
        <tr><th>Status Perkawinan</th><td>${w.perkawinan}</td></tr>
        <tr><th>Pekerjaan</th><td>${w.pekerjaan}</td></tr>
        <tr><th>No HP</th><td>${w.hp}</td></tr>`;
            new bootstrap.Modal('#modalDetail').show();
        }

        // ==== Aksi Tombol ====
        document.getElementById("btnHapus").onclick = function () {
            modeAksi = "hapus";
            new bootstrap.Modal('#modalPassword').show();
        };

        document.getElementById("btnPerbarui").onclick = function () {
            modeAksi = "edit";
            new bootstrap.Modal('#modalEdit').show();
        };

        // ==== Validasi Password ====
        document.getElementById("btnValidasi").onclick = function () {
            const pass = document.getElementById("inputPassword").value;
            if (pass !== "admin123") return alert("Password salah!");
            const index = warga.findIndex(w => w.nik === selectedNik);
            if (index === -1) return;

            if (modeAksi === "hapus") {
                warga.splice(index, 1);
                tampilkanData(warga);
                alert("Data berhasil dihapus!");
                bootstrap.Modal.getInstance(document.getElementById("modalDetail")).hide();
            }
            bootstrap.Modal.getInstance(document.getElementById("modalPassword")).hide();
            document.getElementById("inputPassword").value = "";
        };

        // ==== Simpan Edit ====
        document.getElementById("btnSimpanEdit").onclick = function () {
            const kolom = document.getElementById("selectKolom").value;
            const nilai = document.getElementById("inputNilaiBaru").value;
            const pass = document.getElementById("inputPasswordEdit").value;
            if (pass !== "admin123") return alert("Password salah!");
            const index = warga.findIndex(w => w.nik === selectedNik);
            if (index === -1) return alert("Data tidak ditemukan!");
            warga[index][kolom] = nilai;
            tampilkanData(warga);
            lihatDetail(selectedNik);
            alert("Data berhasil diperbarui!");
            bootstrap.Modal.getInstance(document.getElementById("modalEdit")).hide();
            document.getElementById("inputNilaiBaru").value = "";
            document.getElementById("inputPasswordEdit").value = "";
        };

        // ==== Filter dan Statistik ====
        function applyFilter() {
            const nama = document.getElementById("searchNama").value.toLowerCase();
            const kk = document.getElementById("searchKK").value.toLowerCase();
            const gender = document.getElementById("filterGender").value;
            const hasil = warga.filter(w =>
                w.nama.toLowerCase().includes(nama) &&
                w.kk.toLowerCase().includes(kk) &&
                (gender === "" || w.gender === gender)
            );
            tampilkanData(hasil);
        }

        function resetFilter() {
            document.getElementById("searchNama").value = "";
            document.getElementById("searchKK").value = "";
            document.getElementById("filterGender").value = "";
            tampilkanData(warga);
        }

        function tampilStatistik() {
            const anak = warga.filter(w => w.usia <= 12).length;
            const remaja = warga.filter(w => w.usia >= 13 && w.usia <= 20).length;
            const dewasa = warga.filter(w => w.usia >= 21 && w.usia <= 59).length;
            const lansia = warga.filter(w => w.usia >= 60).length;
            const ctx = document.getElementById('chartUsia').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Anak', 'Remaja', 'Dewasa', 'Lansia'],
                    datasets: [{ label: 'Jumlah Warga', data: [anak, remaja, dewasa, lansia], backgroundColor: ['#a2b17c', '#7b865a', '#5f6842', '#404733'] }]
                },
                options: { scales: { y: { beginAtZero: true } } }
            });
            new bootstrap.Modal('#modalStatistik').show();
        }

        tampilkanData(warga);
    </script>
</body>

</html>